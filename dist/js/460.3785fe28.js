"use strict";(self["webpackChunkhm_toutiao"]=self["webpackChunkhm_toutiao"]||[]).push([[460],{3460:function(t,e,s){s.r(e),s.d(e,{default:function(){return h}});var o=function(){var t=this,e=t._self._c;return e("div",{staticClass:"login-container"},[e("van-nav-bar",{attrs:{title:"登录","left-arrow":""},on:{"click-left":function(e){return t.$router.back(1)}}}),e("van-form",{ref:"form",on:{submit:t.onSubmit}},[e("van-field",{attrs:{name:"mobile","icon-prefix":"toutiao","left-icon":"shouji",placeholder:"请输入手机号码",rules:t.rules.mobile},model:{value:t.user.mobile,callback:function(e){t.$set(t.user,"mobile",e)},expression:"user.mobile"}}),e("van-field",{attrs:{type:"number",name:"code","icon-prefix":"toutiao","left-icon":"yanzhengma",placeholder:"请输入验证码",rules:t.rules.code},scopedSlots:t._u([{key:"button",fn:function(){return[t.isTimeShow?e("van-button",{attrs:{size:"small",type:"primary","native-type":"button"}},[e("van-count-down",{attrs:{time:59e3,format:"ss s"},on:{finish:function(e){t.isTimeShow=!1}}})],1):e("van-button",{attrs:{size:"small",type:"primary"},on:{click:t.sendMsgFn}},[t._v("发送验证码")])]},proxy:!0}]),model:{value:t.user.code,callback:function(e){t.$set(t.user,"code",e)},expression:"user.code"}}),e("div",{staticStyle:{margin:"16px"}},[e("van-button",{attrs:{round:"",block:"",type:"info","native-type":"submit"}},[t._v("提交")])],1)],1)],1)},a=[],i=s(4471);const n=t=>(0,i.Z)({url:`/v1_0/sms/codes/${t}`}),r=t=>(0,i.Z)({url:"/v1_0/authorizations",method:"post",data:t});var u=s(3822),l={name:"Login",data(){return{isTimeShow:!1,user:{mobile:"",code:""},rules:{mobile:[{required:!0,message:"请输入手机号码"},{pattern:/^1(3\d|4[5-9]|5[0-35-9]|6[567]|7[0-8]|8\d|9[0-35-9])\d{8}$/,message:"请输入正确的手机号码"}],code:[{required:!0,message:"请输入验证码"},{pattern:/^\d{6}$/,message:"请输入正确的验证码"}]}}},methods:{...(0,u.OI)(["getUserInfo"]),async onSubmit(){this.$toast.loading({message:"登录中...",forbidClick:!0,duration:0});try{const{data:t}=await r(this.user);this.getUserInfo(t.data)}catch(e){}this.$toast.clear();const t=this.$route.query.url;t?this.$router.replace(t):this.$router.push({path:"/my"})},async sendMsgFn(){try{await this.$refs.form.validate("mobile")}catch(t){return this.$toast.fail(t.message),void console.log(t)}this.isTimeShow=!0;try{await n(this.user.mobile);this.$toast.success("验证码发送成功")}catch(t){const{response:e}=t;this.$toast.fail(e.data.message)}}}},c=l,m=s(1001),d=(0,m.Z)(c,o,a,!1,null,null,null),h=d.exports}}]);